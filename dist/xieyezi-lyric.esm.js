var t=function(){function t(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(i,e,n){return e&&t(i.prototype,e),n&&t(i,n),i}}();var i=/\[(\d{2,}):(\d{2})(?:\.(\d{2,3}))?]/g,e=0,n={title:"ti",artist:"ar",album:"al",offset:"offset",by:"by"};function s(){}export default(function(){function a(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s;!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,a),this.lrc=t,this.tags={},this.lines=[],this.handler=i,this.state=e,this.curLine=0,this._init()}return t(a,[{key:"_init",value:function(){this._initTag(),this._initLines()}},{key:"_initTag",value:function(){for(var t in n){var i=this.lrc.match(new RegExp("\\["+n[t]+":([^\\]]*)]","i"));this.tags[t]=i&&i[1]||""}}},{key:"_initLines",value:function(){for(var t=this.lrc.split("\n"),e=0;e<t.length;e++){var n=t[e],s=i.exec(n);if(s){var a=n.replace(i,"").trim();console.log(a),a&&(3===s[3].length&&(s[3]=s[3]/10),this.lines.push({time:60*s[1]*1e3+1e3*s[2]+10*(s[3]||0),txt:a}))}}this.lines.sort(function(t,i){return t.time-i.time})}},{key:"_findCurNum",value:function(t){for(var i=0;i<this.lines.length;i++)if(t<=this.lines[i].time)return i;return this.lines.length-1}},{key:"_callHandler",value:function(t){t<0||this.handler({txt:this.lines[t].txt,lineNum:t})}},{key:"_playRest",value:function(){var t=this,i=this.lines[this.curNum].time-(+new Date-this.startStamp);this.timer=setTimeout(function(){t._callHandler(t.curNum++),t.curNum<t.lines.length&&1===t.state&&t._playRest()},i)}},{key:"play",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments[1];this.lines.length&&(this.state=1,this.curNum=this._findCurNum(t),this.startStamp=+new Date-t,i||this._callHandler(this.curNum-1),this.curNum<this.lines.length&&(clearTimeout(this.timer),this._playRest()))}},{key:"togglePlay",value:function(){var t=+new Date;1===this.state?(this.stop(),this.pauseStamp=t):(this.state=1,this.play((this.pauseStamp||t)-(this.startStamp||t),!0),this.pauseStamp=0)}},{key:"stop",value:function(){this.state=e,clearTimeout(this.timer)}},{key:"seek",value:function(t){this.play(t)}}]),a}());
